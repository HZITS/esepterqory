<html><head></head><body><div hidden="" by-polymer-bundler=""><dom-module id="article-dialog-module"><template><style include="shared-styles">editor-module{--editor-height:320px;margin-top:16px;}.head{height:60px;padding:16px 0px 0px 16px;color:white;background-color:var(--app-main-color);}.body{overflow:auto;padding:16px;padding-bottom:0;}#dialog{width:700px;background-color:var(--paper-grey-100);}</style><isw-dialog id="dialog" with-backdrop=""><div class="head"><div title=""><template is="dom-if" if="[[!edit]]">Ноав</template><template is="dom-if" if="[[edit]]">авыа</template></div></div><div class="body"><paper-input no-label-float="" label="Title" value="{{title}}"></paper-input><editor-module placeholder="article" id="article"></editor-module><template is="dom-if" if="[[!edit]]"><div class="mainButton" on-click="add">Добавить</div></template><template is="dom-if" if="[[edit]]"><div class="mainButton" on-click="save">Сохранить</div></template></div></isw-dialog></template><script>class DialogarticleModule extends ReduxMixin(Polymer.Element){static get is(){return'article-dialog-module'}static get properties(){return{topic:{type:Object,statePath:'articlesTopic'},edit:{type:Boolean,value:!1},articleToEdit:{type:Object,observer:'articleToEditChanged'}}}articleToEditChanged(a){a&&(this.edit=!0,this.$.article.setHTML(a.article),this.title=a.title)}open(){this.$.dialog.open()}save(){ajax().put('/api/articles/id/'+this.articleToEdit._id,{title:this.title,article:this.$.article.getHTML()}).then(()=>{this.$.article.setHTML(''),this.title='',dispatcher.dispatch('reload-articles'),this.$.dialog.close()})}add(){ajax().post('/api/articles',{path:this.topic.path,article:this.$.article.getHTML(),title:this.title}).then(()=>{dispatcher.dispatch('reload-articles'),this.$.article.setHTML(''),this.title='',this.$.dialog.close()})}}customElements.define(DialogarticleModule.is,DialogarticleModule);</script></dom-module><dom-module id="article-module"><template><style include="shared-styles">:host{display:flex;flex-direction:column;}.head{flex:0 0 40px;line-height:40px;padding:0px 16px;color:var(--paper-grey-600);border-bottom:1px solid var(--paper-grey-300);background-color:var(--paper-grey-100);}.body{flex:1 1 auto;overflow:auto;padding:16px;}.edit{height:40px;margin-left:8px;cursor:pointer;}</style><div class="head layout horizontal justified"><template is="dom-if" if="[[data]]"><div></div><div class="layout horizontal center"><iron-icon class="edit" on-click="edit" icon="icons:create"></iron-icon><iron-icon class="edit" on-click="delete" icon="icons:delete"></iron-icon></div></template></div><div class="body"><template is="dom-if" if="[[data]]"><h2 class="title">[[article.title]]</h2><div id="article"></div></template></div><article-dialog-module id="articleDialog" article-to-edit="[[article]]"></article-dialog-module></template><script>class DashboardarticleModule extends ReduxMixin(Polymer.Element){static get is(){return'article-module'}static get properties(){return{data:{type:Object,statePath:'currentArticle',observer:'dataChanged'},article:Object}}connectedCallback(){super.connectedCallback(),this.logged=Cookies.get('logged')}dataChanged(a){a&&ajax().get('/api/articles/id/'+a._id).then((a)=>{this.article=a,console.log(a.article),this.shadowRoot.querySelector('#article').innerHTML=a.article})}edit(){this.$.articleDialog.open()}delete(){console.log(this.article.path),ajax().delete('/api/articles/id/'+this.article._id,{data:{path:this.article.path}}).then(()=>{dispatcher.dispatch('reload-articles')})}}customElements.define(DashboardarticleModule.is,DashboardarticleModule);</script></dom-module><dom-module id="articles-cell-module"><template><style include="shared-styles">:host{padding:8px 8px 8px 16px;border-bottom:1px solid var(--paper-grey-300);}.wrapper:hover iron-icon.edit{display:inline;}iron-icon{color:var(--paper-grey-600);}.edit{display:none;margin-right:8px;cursor:pointer;}#des{padding:8px 0px;}#des:focus{outline:none;}.topic{background-color:var(--paper-grey-200);border-radius:4px;padding:2px 4px;color:var(--paper-grey-600);font-size:14px;}.title{font-weight:500;}</style><div class="wrapper"><div class="head layout horizontal justified"><div class="title">[[article.title]]</div></div><div id="des"></div><template is="dom-repeat" items="[[article.topics]]"><a class="topic" href$="/dashboard/[[item._id]]">[[item.title]]</a></template></div></template><script>class DashboardarticlesCellModule extends Polymer.Element{static get is(){return'articles-cell-module'}static get properties(){return{problem:{type:Object,observer:'problemChanged'},selected:{type:Object,observer:'selectedChanged'}}}selectedChanged(a){this.style.backgroundColor=a?'#f5f5f5':'white'}problemChanged(a){this.$.des.innerHTML=a.problem}}customElements.define(DashboardarticlesCellModule.is,DashboardarticlesCellModule);</script></dom-module></div><dom-module id="articles-module"><template><style include="shared-styles"></style><dashboard-module><topics-tree-module title="articles" slot="section1"></topics-tree-module><section-module slot="section2" show-title="" title="[[article.title]]" style="width:500px" button-title="[[article.buttonTitle]]" event="add-article"><iron-list slot="list" id="articles" items="[[articles]]" selection-enabled="" selected-item="{{currentArticle}}"><template><articles-cell-module selected="[[selected]]" article="[[item]]"></articles-cell-module></template></iron-list><pages-module slot="footer" topic="[[topic]]" title="articles"></pages-module></section-module><article-module slot="section3"></article-module></dashboard-module><article-dialog-module id="articleDialog"></article-dialog-module></template><script>class ArticlesModule extends ReduxMixin(Polymer.Element){static get is(){return'articles-module'}static get properties(){return{article:Object,currentArticle:{type:Object,observer:'currentArticleChanged'},title:{type:String,value:'articles'},topic:{type:Object,statePath(a){return a.articlesTopic}},page:{type:Number,statePath:'articlesPage'}}}static get observers(){return['getArticles(topic, page)']}connectedCallback(){super.connectedCallback(),dispatcher.subscribe('math-rendered',()=>{this.$.articles.notifyResize()}),this.addEventListener('add-article',()=>{this.$.articleDialog.open()}),dispatcher.subscribe('reload-articles',()=>{this.getArticles(this.topic,1)})}getArticles(a,b){a&&a.path&&b&&(this.pageDebouncer=Polymer.Debouncer.debounce(this.pageDebouncer,Polymer.Async.timeOut.after(100),()=>{this.article=1<a.path.split('/').length?{title:'\u0421\u0442\u0430\u0442\u044C\u0438 \u0432: '+a.title,buttonTitle:'\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0441\u0442\u0430\u0442\u044C\u044E'}:null,ajax().get('/api/articles/topic/'+a._id+'/'+b).then((a)=>{this.articles=a})}))}currentArticleChanged(a){this.dispatch({type:'currentArticle',value:a})}}customElements.define(ArticlesModule.is,ArticlesModule);</script></dom-module></body></html>