<link rel="import" href="../../bower_components/polymer/polymer-element.html">

<dom-module id="home-module">
    <template>
        <style include="shared-styles">
            :host{
                display: flex;
                flex-direction: row;
                height: calc(100vh - 82px)
            }
            :host > list-module{
                flex: 1 ;
                border-top: 2px solid var(--paper-grey-300);
                border-right: 1px solid var(--paper-grey-300)
            }
            .listItem{
                height: 32px;
                line-height: 32px;
                color: var(--paper-grey-700);
                padding-left: 16px; 
            }
            .listItem:hover{
                color: black;
                background-color: var(--paper-grey-300);
                cursor: pointer
            }
        </style>
        <list-module
            title-link="Каталог по темам"
            link="/dashboard/sections"
        >
            <div class="list" slot="list">
                <iron-list items="[[topic.subtopics]]" selection-enabled selected-item="{{selectedItem}}">
                    <template>
                        <a class="listItem" href$="dashboard/[[item._id]]">
                            [[item.title]]([[item.problemsCount]])
                        </a>
                    </template>
                </iron-list>
            </div>
        </list-module>
        <list-module
            title-link="Каталог по источникам"
            link="/dashboard/sources"
        >
            <div class="list" slot="list">
                <iron-list items="[[items]]" selection-enabled selected-item="{{selectedItem}}">
                    <template>
                        <div class="listItem">
                            [[item.name]]
                        </div>
                    </template>
                </iron-list>
            </div>
        </list-module>
        <list-module
           title-link="Теория"
        >
            <div class="list" slot="list">
                <iron-list items="[[topic.subtopics]]" selection-enabled selected-item="{{selectedItem}}">
                    <template>
                        <div class="listItem">
                            [[item.name]]
                        </div>
                    </template>
                </iron-list>
            </div>
        </list-module>
        <iron-ajax
        auto
        url="/api/topics/sections"
        params='{"populate":true}'
        last-response="{{topic}}"
        on-response="handleResponse"
        debounce-duration="300"
    
        ></iron-ajax>
    </template>
    <script>
        class HomeModule extends Polymer.Element {

            static get is() { return 'home-module' }

            static get properties() {
                return {
                }
            }

            static get observers() {
                return [
                ]
            }
            handleResponse(e){
                console.log(e.detail.response)
            }
            connectedCallback(){
                super.connectedCallback()

                // db.collection('Sections').get().then(doc => {
                //     this.sections = items(doc)
                // })
            }

        }
        customElements.define(HomeModule.is, HomeModule);
    </script>
</dom-module>